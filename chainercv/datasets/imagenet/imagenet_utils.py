import filelock
import os

from chainer.dataset import download
from chainercv import utils

root = 'pfnet/chainercv/imagenet'
devkit_url = 'http://image-net.org/image/ilsvrc2014/ILSVRC2014_devkit.tgz'


def get_ilsvrc_devkit():
    data_root = download.get_dataset_directory(root)

    with filelock.FileLock(os.path.join(data_root, 'lock')):
        base_dir = os.path.join(data_root, 'ILSVRC2014_devkit')
        if os.path.exists(base_dir):
            return data_root
        download_file_path = utils.cached_download(devkit_url)
        ext = os.path.splitext(devkit_url)[1]
        utils.extractall(download_file_path, data_root, ext)
    return data_root


# Look up meta_det.mat from dev kit
imagenet_det_bbox_label_names = (
    'accordion',
    'airplane',
    'ant',
    'antelope',
    'apple',
    'armadillo',
    'artichoke',
    'axe',
    'baby bed',
    'backpack',
    'bagel',
    'balance beam',
    'banana',
    'band aid',
    'banjo',
    'baseball',
    'basketball',
    'bathing cap',
    'beaker',
    'bear',
    'bee',
    'bell pepper',
    'bench',
    'bicycle',
    'binder',
    'bird',
    'bookshelf',
    'bow tie',
    'bow',
    'bowl',
    'brassiere',
    'burrito',
    'bus',
    'butterfly',
    'camel',
    'can opener',
    'car',
    'cart',
    'cattle',
    'cello',
    'centipede',
    'chain saw',
    'chair',
    'chime',
    'cocktail shaker',
    'coffee maker',
    'computer keyboard',
    'computer mouse',
    'corkscrew',
    'cream',
    'croquet ball',
    'crutch',
    'cucumber',
    'cup or mug',
    'diaper',
    'digital clock',
    'dishwasher',
    'dog',
    'domestic cat',
    'dragonfly',
    'drum',
    'dumbbell',
    'electric fan',
    'elephant',
    'face powder',
    'fig',
    'filing cabinet',
    'flower pot',
    'flute',
    'fox',
    'french horn',
    'frog',
    'frying pan',
    'giant panda',
    'goldfish',
    'golf ball',
    'golfcart',
    'guacamole',
    'guitar',
    'hair dryer',
    'hair spray',
    'hamburger',
    'hammer',
    'hamster',
    'harmonica',
    'harp',
    'hat with a wide brim',
    'head cabbage',
    'helmet',
    'hippopotamus',
    'horizontal bar',
    'horse',
    'hotdog',
    'iPod',
    'isopod',
    'jellyfish',
    'koala bear',
    'ladle',
    'ladybug',
    'lamp',
    'laptop',
    'lemon',
    'lion',
    'lipstick',
    'lizard',
    'lobster',
    'maillot',
    'maraca',
    'microphone',
    'microwave',
    'milk can',
    'miniskirt',
    'monkey',
    'motorcycle',
    'mushroom',
    'nail',
    'neck brace',
    'oboe',
    'orange',
    'otter',
    'pencil box',
    'pencil sharpener',
    'perfume',
    'person',
    'piano',
    'pineapple',
    'ping-pong ball',
    'pitcher',
    'pizza',
    'plastic bag',
    'plate rack',
    'pomegranate',
    'popsicle',
    'porcupine',
    'power drill',
    'pretzel',
    'printer',
    'puck',
    'punching bag',
    'purse',
    'rabbit',
    'racket',
    'ray',
    'red panda',
    'refrigerator',
    'remote control',
    'rubber eraser',
    'rugby ball',
    'ruler',
    'salt or pepper shaker',
    'saxophone',
    'scorpion',
    'screwdriver',
    'seal',
    'sheep',
    'ski',
    'skunk',
    'snail',
    'snake',
    'snowmobile',
    'snowplow',
    'soap dispenser',
    'soccer ball',
    'sofa',
    'spatula',
    'squirrel',
    'starfish',
    'stethoscope',
    'stove',
    'strainer',
    'strawberry',
    'stretcher',
    'sunglasses',
    'swimming trunks',
    'swine',
    'syringe',
    'table',
    'tape player',
    'tennis ball',
    'tick',
    'tie',
    'tiger',
    'toaster',
    'traffic light',
    'train',
    'trombone',
    'trumpet',
    'turtle',
    'tv or monitor',
    'unicycle',
    'vacuum',
    'violin',
    'volleyball',
    'waffle iron',
    'washer',
    'water bottle',
    'watercraft',
    'whale',
    'wine bottle',
    'zebra')


imagenet_det_synset_ids = (
    'n02672831',
    'n02691156',
    'n02219486',
    'n02419796',
    'n07739125',
    'n02454379',
    'n07718747',
    'n02764044',
    'n02766320',
    'n02769748',
    'n07693725',
    'n02777292',
    'n07753592',
    'n02786058',
    'n02787622',
    'n02799071',
    'n02802426',
    'n02807133',
    'n02815834',
    'n02131653',
    'n02206856',
    'n07720875',
    'n02828884',
    'n02834778',
    'n02840245',
    'n01503061',
    'n02870880',
    'n02883205',
    'n02879718',
    'n02880940',
    'n02892767',
    'n07880968',
    'n02924116',
    'n02274259',
    'n02437136',
    'n02951585',
    'n02958343',
    'n02970849',
    'n02402425',
    'n02992211',
    'n01784675',
    'n03000684',
    'n03001627',
    'n03017168',
    'n03062245',
    'n03063338',
    'n03085013',
    'n03793489',
    'n03109150',
    'n03128519',
    'n03134739',
    'n03141823',
    'n07718472',
    'n03797390',
    'n03188531',
    'n03196217',
    'n03207941',
    'n02084071',
    'n02121808',
    'n02268443',
    'n03249569',
    'n03255030',
    'n03271574',
    'n02503517',
    'n03314780',
    'n07753113',
    'n03337140',
    'n03991062',
    'n03372029',
    'n02118333',
    'n03394916',
    'n01639765',
    'n03400231',
    'n02510455',
    'n01443537',
    'n03445777',
    'n03445924',
    'n07583066',
    'n03467517',
    'n03483316',
    'n03476991',
    'n07697100',
    'n03481172',
    'n02342885',
    'n03494278',
    'n03495258',
    'n03124170',
    'n07714571',
    'n03513137',
    'n02398521',
    'n03535780',
    'n02374451',
    'n07697537',
    'n03584254',
    'n01990800',
    'n01910747',
    'n01882714',
    'n03633091',
    'n02165456',
    'n03636649',
    'n03642806',
    'n07749582',
    'n02129165',
    'n03676483',
    'n01674464',
    'n01982650',
    'n03710721',
    'n03720891',
    'n03759954',
    'n03761084',
    'n03764736',
    'n03770439',
    'n02484322',
    'n03790512',
    'n07734744',
    'n03804744',
    'n03814639',
    'n03838899',
    'n07747607',
    'n02444819',
    'n03908618',
    'n03908714',
    'n03916031',
    'n00007846',
    'n03928116',
    'n07753275',
    'n03942813',
    'n03950228',
    'n07873807',
    'n03958227',
    'n03961711',
    'n07768694',
    'n07615774',
    'n02346627',
    'n03995372',
    'n07695742',
    'n04004767',
    'n04019541',
    'n04023962',
    'n04026417',
    'n02324045',
    'n04039381',
    'n01495701',
    'n02509815',
    'n04070727',
    'n04074963',
    'n04116512',
    'n04118538',
    'n04118776',
    'n04131690',
    'n04141076',
    'n01770393',
    'n04154565',
    'n02076196',
    'n02411705',
    'n04228054',
    'n02445715',
    'n01944390',
    'n01726692',
    'n04252077',
    'n04252225',
    'n04254120',
    'n04254680',
    'n04256520',
    'n04270147',
    'n02355227',
    'n02317335',
    'n04317175',
    'n04330267',
    'n04332243',
    'n07745940',
    'n04336792',
    'n04356056',
    'n04371430',
    'n02395003',
    'n04376876',
    'n04379243',
    'n04392985',
    'n04409515',
    'n01776313',
    'n04591157',
    'n02129604',
    'n04442312',
    'n06874185',
    'n04468005',
    'n04487394',
    'n03110669',
    'n01662784',
    'n03211117',
    'n04509417',
    'n04517823',
    'n04536866',
    'n04540053',
    'n04542943',
    'n04554684',
    'n04557648',
    'n04530566',
    'n02062744',
    'n04591713',
    'n02391049')
